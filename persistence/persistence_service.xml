<?xml version="1.0" encoding="UTF-8"?>
<dds>
  <qos_library name="PSQos">
    <!-- QoS library used by the persistence service -->
    <qos_profile name="PSDefault">
      <!-- Ensure messages are stored reliably and completely -->
      <datawriter_qos>
        <reliability><kind>RELIABLE_RELIABILITY_QOS</kind></reliability>
        <history><kind>KEEP_ALL_HISTORY_QOS</kind></history>
      </datawriter_qos>
      <datareader_qos>
        <reliability><kind>RELIABLE_RELIABILITY_QOS</kind></reliability>
        <history><kind>KEEP_ALL_HISTORY_QOS</kind></history>
      </datareader_qos>
    </qos_profile>
  </qos_library>

  <!-- Main persistence service definition -->
  <persistence_service name="ChatPS">
    <!-- Where to store persistent data -->
    <persistent_storage>
      <filesystem>
        <directory>persistence\data</directory>
        <file_prefix>chat</file_prefix>
      </filesystem>
    </persistent_storage>

    <!-- The service joins the same DDS domain as the chat app -->
    <participant name="PSParticipant">
      <domain_id>0</domain_id>

      <persistence_group name="ChatMsgs" filter="message">
        <datareader_qos base_name="PSQos::PSDefault"/>
        <datawriter_qos base_name="PSQos::PSDefault"/>
      </persistence_group>
    </participant>
  </persistence_service>
</dds>
